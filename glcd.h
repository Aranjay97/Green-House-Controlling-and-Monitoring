#include <p18f4550.h>
#include <delays.h>

#define DATA2gLCD PORTB
#define E PORTEbits.RE2
#define RW PORTEbits.RE1
#define RS PORTEbits.RE0
#define CS1 PORTDbits.RD2
#define CS2 PORTDbits.RD3
#define RES PORTDbits.RD4


//void busy(void);
void GLCDcmd(unsigned char x);
void GLCDdata(unsigned char x);
void GLCDinit(void);
void cls(void);
void loadimg(rom char *image, unsigned int len);
void delay_us(unsigned char x);
void abcs(unsigned int qw);
void delay1();

unsigned char abc[8]={0x01,0x02,0x04,0x08,0x10,0x20,0x40,0x80};
unsigned rom char image[1024]={
0x60,0x58,0x48,0x48,0x88,0x00,0xF0,0x08,0x08,0x08,0xF0,0x00,0x22,0xFF,0x02,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x40,0x40,0xC0,0x40,0x40,0x00,0xC0,0x40,0x40,0x00,0xC0,0x40,
0xC0,0x80,0xC0,0x40,0xC0,0x00,0xC0,0x40,0x40,0x80,0x00,0xC0,0x40,0x40,0x00,0xC0,
0x40,0xC0,0x00,0x00,0x00,0x00,0xC0,0x80,0x00,0x40,0x40,0xC0,0x40,0x40,0x00,0xC0,
0x00,0x00,0xC0,0x00,0xC0,0x40,0xC0,0x00,0x00,0xC0,0x40,0x40,0x00,0x00,0x00,0x00,

0x02,0x84,0x44,0xE4,0x03,0x00,0xC3,0x24,0x24,0x24,0xC3,0x00,0x80,0xFF,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x0F,0x00,0x00,0x00,0x0F,0x09,0x09,0x00,0x0F,0x00,
0x00,0x01,0x00,0x00,0x0F,0x00,0x0F,0x02,0x02,0x01,0x00,0x0F,0x09,0x09,0x00,0x0F,
0x02,0x05,0x08,0x00,0x08,0x87,0x04,0x07,0x0C,0x00,0x00,0x0F,0x00,0x00,0x00,0x07,
0x08,0x08,0x07,0x00,0x0F,0x02,0x05,0x08,0x00,0x0F,0x09,0x09,0x00,0x00,0x00,0x00,

0x06,0x85,0x84,0x9F,0x04,0x00,0x0F,0x90,0x90,0x90,0x0F,0x00,0x00,0xFF,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x01,0x02,0x01,0x00,0x3E,0x41,0x41,0x41,0x41,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,

0x21,0x40,0x44,0x44,0x3B,0x00,0x3F,0x40,0x40,0x40,0x3F,0x00,0x02,0xFF,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,

0x04,0x82,0x42,0x22,0x1C,0x00,0xFC,0x02,0x02,0x02,0xFC,0x00,0x08,0xFF,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xE0,0x20,0x60,0xC0,0x60,0x20,
0xE0,0x00,0xE0,0x20,0x20,0x20,0xE0,0x00,0x20,0x20,0xE0,0x20,0x20,0x00,0xE0,0x20,
0x20,0x20,0xE0,0x00,0xE0,0x20,0xE0,0x00,0x00,0x00,0x00,0x20,0x20,0xE0,0x20,0x20,
0x00,0x00,0xE0,0xA0,0xA0,0xA0,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,

0x21,0x11,0xF9,0x01,0x01,0x00,0xF0,0x09,0x09,0x09,0xF0,0x00,0x20,0xFF,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x07,0x00,0x00,0x00,0x00,0x00,
0x07,0x00,0x07,0x04,0x04,0x04,0x07,0x00,0x00,0x00,0x07,0x00,0x00,0x00,0x07,0x04,
0x04,0x04,0x07,0x00,0x07,0x01,0x02,0x04,0x00,0x00,0x00,0x04,0x04,0x07,0x04,0x04,
0x00,0x00,0x04,0x04,0x04,0x07,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,

0x80,0xC0,0x87,0x80,0x80,0x80,0x83,0x84,0x84,0x84,0x83,0x80,0x80,0xFF,0x80,0x80,
0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,
0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,
0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0xC0,0x80,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,

0x00,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x40,0xFF,0x40,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
};

unsigned char ON[19]={0xFF,0x81,0x81,0x81,0x81,0xFF,0x00,0x00,0x00,0x00,0xFF,0x02,0x04,0x08,0x10,0x20,0x40,0xFF,0x00};
unsigned char OFF[19]={0xFF,0x81,0x81,0x81,0x81,0xFF,0x00,0x00,0xFF,0x09,0x09,0x01,0x01,0x00,0xFF,0x09,0x09,0x01,0x01};
unsigned char numbers[50]={ 0x7E,0x81,0x81,0x81,0x7E,
							0x04,0x02,0xFF,0x00,0x00,
							0x82,0xC1,0xA1,0x91,0x8E,
							0x42,0x81,0x89,0x89,0x76,
							0x30,0x2C,0x22,0xFF,0x20,
							0x4C,0x8B,0x89,0x89,0x71,
							0x7E,0x89,0x89,0x89,0x72,
							0x01,0xE1,0x19,0x07,0x01,
							0x76,0x89,0x89,0x89,0x76,
							0x4E,0x91,0x91,0x91,0x7E,
                           };
void loadimg(rom char *image, unsigned int len)
{
char i,x,y;
int z = 0;
while(z != len)            
{
for(i=0;i<8;i++)
{
CS1 = 0;
CS2 = 1;
y = 0xB8 + i;
GLCDcmd(y);  
GLCDcmd(0x40);
for(x=0;x<64;x++)
{
if(z == len)
break;
GLCDdata(*image);
image++;
z++;
}
CS1 = 1;
CS2 = 0;
y = 0xB8 + i;
GLCDcmd(y);  
GLCDcmd(0x40);

for(x=0;x<64;x++)
{
if(z == len)
break;
GLCDdata(*image);
image++;
z++;
}
if(z == len)
break;
}
}
}


void GLCDcmd(unsigned char x)
{
RS = RW = 0;
DATA2gLCD = x;
E = 1;
delay_us(1);
E = 0;
}

void GLCDdata(unsigned char x)
{
RS = 1;
RW = 0;
DATA2gLCD = x;
E = 1;
delay_us(1);
E = 0;
}

void GLCDinit(void)
{
RES = 1;
E = 0;
CS1 = CS2 = 1;
GLCDcmd(0x3f);			//turn on display
GLCDcmd(0x40);			//go to left side
GLCDcmd(0xb8);			//go to top page
cls();						//clear the screen
}	


void cls(void)			//clear screen
{
char x,y;
CS1 = CS2 = 1;
for(y=0;y<8;y++)		//page loop
{
GLCDcmd(0xb8 + y);
for(x=0;x<64;x++)	//y loop
GLCDdata(0x00);
}
//GLCDcmd(0xc0);		//display start line = 0
GLCDcmd(0x40);		//go to left side
GLCDcmd(0xb8);		//go to top page
}


void delay_us(unsigned char x)
{
char var1,y;
for(var1=0;var1<x;var1++)
{				
for(y=0;y<5;y++)
Delay1TCY();
} 
}

